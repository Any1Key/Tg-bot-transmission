# Tg-bot-transmission

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Transmission —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é –≤ Telegram:
- –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ `magnet` –∏ `.torrent`
- –≤—ã–±–æ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–π –ø–∞–ø–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
- –ø—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∑–æ–∫
- –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ –∑–∞–ø—É—Å–∫ –Ω–µ–¥–æ–∫–∞—á–∞–Ω–Ω—ã—Ö —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤
- –±–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Transmission
- –ø–∞—É–∑–∞/–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤

## 1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker + Docker Compose
- Telegram Bot Token (—á–µ—Ä–µ–∑ `@BotFather`)
- –î–æ—Å—Ç—É–ø –∫ Transmission RPC

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `bot/` - –∫–æ–¥ Telegram-–±–æ—Ç–∞ (`aiogram`)
- `migrations/` - –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic
- `.env.example` - –ø—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `config.yml.example` - –ø—Ä–∏–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–ø–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏
- `docker-compose.yml` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã Transmission + bot
- `Dockerfile` - –æ–±—Ä–∞–∑ –±–æ—Ç–∞

## 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –®–∞–≥ 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
git clone git@github.com:Any1Key/Tg-bot-transmission.git
cd Tg-bot-transmission
```

### –®–∞–≥ 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `.env`

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ `.env`:

```env
TOKEN=your_telegram_bot_token_here
TRANSMISSION_URL=http://transmission:9091/transmission/rpc
TRANSMISSION_USER=change_me_user
TRANSMISSION_PASS=change_me_password
ADMIN_USER_IDS=123456789
DATABASE_URL=sqlite+aiosqlite:///./data/bot.db
CONFIG_PATH=/app/config.yml
POLL_INTERVAL_SECONDS=45
THROTTLE_SECONDS=1.0
LOG_LEVEL=INFO
```

### –®–∞–≥ 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–ø–æ–∫

```bash
cp config.yml.example config.yml
```

–ü—Ä–∏–º–µ—Ä `config.yml`:

```yaml
download_dirs:
  –§–∏–ª—å–º—ã: "/downloads/movies"
  –°–µ—Ä–∏–∞–ª—ã: "/downloads/series"
  –ú—É–∑—ã–∫–∞: "/downloads/music"
  –î—Ä—É–≥–æ–µ: "/downloads/misc"
```

### –®–∞–≥ 4. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker compose up -d --build
```

### –®–∞–≥ 5. –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
docker compose ps
docker compose logs --tail=100 bot
```

## 4. –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä—Ä–µ–Ω—Ç–∞

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ —á–∞—Ç `magnet:?....`
2. –ë–æ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç —Å–ø–∏—Å–æ–∫ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–ø–æ–∫
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É –∫–Ω–æ–ø–∫–æ–π `üìÅ –í—ã–±—Ä–∞—Ç—å: ...`

–ò–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–∞–π–ª `.torrent` - —Å—Ü–µ–Ω–∞—Ä–∏–π —Ç–∞–∫–æ–π –∂–µ.

### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

- `üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ç–∏`
  - –æ–±—â–∏–π –æ–±—ä—ë–º —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ/–æ—Ç–¥–∞–Ω–Ω–æ–≥–æ
  - —Ç–µ–∫—É—â–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ DL/UL
  - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤

- `üóÇÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–ø–∫–∏`
  - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –ø–∞–ø–∫–∏ –∏–∑ `config.yml`

- `üìú –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–æ–∫`
  - —Å–ø–∏—Å–æ–∫ –≤–∞—à–∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤ —Å —Ç–µ–∫—É—â–∏–º —Å—Ç–∞—Ç—É—Å–æ–º
  - –ø–∞–≥–∏–Ω–∞—Ü–∏—è –ø–æ 8 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É

- `‚¨áÔ∏è –ù–µ–¥–æ–∫–∞—á–∞–Ω–Ω—ã–µ —Ç–æ—Ä—Ä–µ–Ω—Ç—ã`
  - —Å–ø–∏—Å–æ–∫ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤
  - –∫–Ω–æ–ø–∫–∞ `‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å: ...` –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ—Ä—Ä–µ–Ω—Ç–∞
  - –∫–Ω–æ–ø–∫–∞ `‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤—Å–µ –Ω–µ–¥–æ–∫–∞—á–∞–Ω–Ω—ã–µ`
  - –∫–Ω–æ–ø–∫–∞ `üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫`

- `‚è∏Ô∏è –ü–∞—É–∑–∞ –≤—Å–µ—Ö —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤`
  - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ —Ç–æ—Ä—Ä–µ–Ω—Ç—ã –≤ Transmission

- `‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤—Å–µ —Ç–æ—Ä—Ä–µ–Ω—Ç—ã`
  - –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Ç–æ—Ä—Ä–µ–Ω—Ç—ã –≤ Transmission

- `üè† –û—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é`
  - –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

### –ö–æ–º–∞–Ω–¥—ã

- `/start` - –æ—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/menu` - –æ—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/history` - –∏—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–æ–∫
- `/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `/folders` - —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–ø–∫–∏
- `/incomplete` - –Ω–µ–¥–æ–∫–∞—á–∞–Ω–Ω—ã–µ —Ç–æ—Ä—Ä–µ–Ω—Ç—ã
- `/cancel` - —Å–±—Ä–æ—Å–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ FSM

## 5. –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è ‚Äú–Ω–µ–¥–æ–∫–∞—á–∞–Ω–Ω—ã–π‚Äù —Ç–æ—Ä—Ä–µ–Ω—Ç

–¢–æ—Ä—Ä–µ–Ω—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–¥–æ–∫–∞—á–∞–Ω–Ω—ã–º, –µ—Å–ª–∏ –æ–Ω –Ω–µ –∑–∞–≤–µ—Ä—à—ë–Ω –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º RPC:
- `percentDone < 1.0`, –∏–ª–∏
- `leftUntilDone > 0`, –∏–ª–∏
- `isFinished == false`

–ï—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω –ª—é–±–æ–π –ø—Ä–∏–∑–Ω–∞–∫ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ—Å—Ç–∏ (`percentDone >= 1` / `leftUntilDone <= 0` / `isFinished == true`), —Ç–æ—Ä—Ä–µ–Ω—Ç –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Å–ø–∏—Å–æ–∫ ‚Äú–ù–µ–¥–æ–∫–∞—á–∞–Ω–Ω—ã–µ‚Äù.

## 6. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

- –ë–î –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: SQLite (`/app/data/bot.db`)
- –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –±–æ—Ç–∞:
  - –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞: `alembic upgrade head && python -m bot.main`

–ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é:

```bash
docker compose run --rm bot alembic upgrade head
```

## 7. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π `.env`
- –û—Å—Ç–∞–≤–ª—è–π—Ç–µ RPC-–ø–æ—Ä—Ç Transmission –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –ª–æ–∫–∞–ª—å–Ω–æ (`127.0.0.1:9091:9091`)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Transmission —Å —Å–∏–ª—å–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º
- –£–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `ADMIN_USER_IDS`, –∏–Ω–∞—á–µ –¥–æ—Å—Ç—É–ø –±—É–¥–µ—Ç –∑–∞–ø—Ä–µ—â—ë–Ω –≤—Å–µ–º

## 8. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

- –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:
  - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `TOKEN` –∏ `ADMIN_USER_IDS`
  - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker compose logs --tail=200 bot`

- –ù–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ—Ä—Ä–µ–Ω—Ç:
  - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å `TRANSMISSION_URL`
  - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `TRANSMISSION_USER` / `TRANSMISSION_PASS`

- –ù–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–∞–ø–∫–∏:
  - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `config.yml` –∏ –∫–ª—é—á `download_dirs`

- –ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞—è:
  - –∏—Å—Ç–æ—Ä–∏—è –≤–µ–¥—ë—Ç—Å—è —Å –º–æ–º–µ–Ω—Ç–∞, –∫–æ–≥–¥–∞ —Ç–æ—Ä—Ä–µ–Ω—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞

## 9. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
git pull
docker compose up -d --build
```

## 10. –õ–∏—Ü–æ –ø—Ä–æ–µ–∫—Ç–∞

Copyright (c) 2026 Any1Key

## 11. –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∞–≤—Ç–æ—Ä–∞

–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –æ–∫–∞–∑–∞–ª—Å—è –ø–æ–ª–µ–∑–Ω—ã–º, –º–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∞–≤—Ç–æ—Ä–∞ –¥–æ–Ω–∞—Ç–æ–º:

- –ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã: `2200 2480 0026 2096`
- –ü–æ–ª—É—á–∞—Ç–µ–ª—å: `–†—É—Å–ª–∞–Ω`

–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É.

–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ–µ –∏ –Ω–µ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤.
